## 第二章 基本遗传算法

### 2.1 基本遗传算法描述

基于对自然界中生物遗传与进化机理的模仿，针对不同的问题，很多学者设计了很多不同的编码方式来表示问题的可行解，开发出了许多种不同的遗传算子来模仿不同环境下的生物遗传特性。这样，由不同的编码方式和不同的遗传算子就构成了各种不同的遗传算法。但这些遗传算法都具有共同的特性，即通过对生物遗传和进化过程中选择、交叉、变异机理的模仿，来完成对问题的最优解的自适应搜索过程。基于这一共同特性，*Glodberg* 总结出了一种同一的最基本的遗传算法-基本遗传算法（*Simple Genetic Algorithms, SGA*）。

#### 2.1.1 基本遗传算法的构成要素

1. 染色体编码方法。基本遗传算法使用固定长度的二进制符号串来表示群体中的个体，其等位基因是由二进制符号集$ {0, 1} $ 所组成的。初始群体中各个个体的基因值可用均匀分布的随机数来生成。如
   $$
   X=100111001000101101
   $$
   上式就可以表示一个个体，该个体的染色体长度是18。

2. 个体适应度评价。基本遗传算法按与个体适应度成正比的概率来决定当前群体中每个个体遗传到下一代群体中的机会多少。为了正确计算这个概率，这里要求所有个体的适应度必须为正数或者零。

3. 遗传算子。基本遗传算法使用下述三种遗传算子：

* 选择运算使用比例选择算子；
* 交叉运算使用单点交叉算子；
* 变异运算使用基本位变异算子或均匀变异算子。

4. 基本遗传算法的运行参数：

* $M$ ：群体大小，即群体中所含个体的数量，一般取20~100；
* $T$ ：遗传运算的终止进化代数，一般取100~500；
* $P_c$ ：交叉概率，一般取值为0.4~0.99；
* $P_m$ ：变异概率，一般取值为0.0001~0.1。

这四个参数对遗传算法的求解结果和求解效率都有一定的影响，需进行多次试算之后得出合适的参数取值。

#### 2.1.2 基本遗传算法描述

```matlab
Procedure SGA
begin
  initialize P(0)
  t = 0;
  while(t <= T) do
    for i=1 to M do
      Evaluate fitness of P(t)
    end for
    for i=1 to M do
      Select operation to P(t)
    end for
    for i=1 to M/2 do
      Crossover operation to P(t)
    end for
    for i=1 to M do
      Mutation operation to P(t)
    end for
    for i=1 to M do
      P(t+1) = P(t)
    end for
    t = t+1;
  end while
end
```

#### 2.1.3 基本遗传算法的形式化定义

基本遗传算法可定义为一个八元组：
$$
SGA = (C, E, P_0, M, \Phi, \Gamma, \Psi, T)
$$
式中 $C$ --个体的编码方法；$E$ --个体适应度评价函数；$P_0$ --初始种群；$M$ --种群大小；$\Phi$ --选择算子；$\Gamma$ --交叉算子；$\Psi$ --变异算子；$T$ --运算终止条件。

### 2.2 基本遗传算法的实现

#### 2.2.1 个体适应度评价

在遗传算法中，以个体适应度的大小来确定该个体被遗传到下一代的概率。基本遗传算法使用比例选择算子来确定群体中各个个体遗传到下一代群体中的数量。为了正确计算不同情况下各个个体的遗传概率，要求所有的个体的适应度必须为正数或者零，不能是负数。

对于求目标函数最小值的优化问题，理论上只需简单地对其增加一个负号就可将其转换为目标函数最大值的优化问题，即
$$
min  f(x) = max(-f(x))
$$
当优化目标是求函数最大值，并且目标函数总取正数时，可以直接设定个体的适应度$F(x)$ 就等于相应的目标函数值$f(x)$ ，即
$$
F(x)=f(x)
$$
为了满足适应度取非负数的要求，基本遗传算法一般采用下面两种方法之一将目标函数值$f(x)$ 变换为个体的适应度$F(x)$。

**方法一** 对于求目标函数最大值的优化问题，变换方法为
$$
F(x) = f(x) + C_{min},  f(x)+C_{min}>0;
F(x)=0,f(x)+C_{min} <= 0
$$
式中，$C_{min}$ 为一个适当相对比较小的数，可用下面几种方法来选取。

1. 预先指定的一个较小数；
2. 进化到当前代为止的最小目标函数值；
3. 当前代或者近几代群体中的最小目标函数值。

**方法二** 对于求目标函数最小值的优化问题，变换方法为
$$
F(x)=C_{max}-f(x),f(x)<C_{max};F(x)=0,f(x)>=C_{max}
$$
式中，$C_{max}$ 为一个适当地相对比较大的数，可用下面几种方法获取：

1. 预先指定的一个较大的数；
2. 进化到当前代为止的最大目标函数值；
3. 当前代或者近几代群体中的最大目标函数值。

#### 2.2.2 比例选择算子

**轮盘赌**

> 1. 先计算出群体中所有个体的适应度的总和；
> 2. 其次计算出每个个体的相对适应度的大小，它即是各个个体被遗传到下一代的概率；
> 3. 最后使用模拟赌盘操作（即0~1之间的随机数）来确定各个个体被选中的次数。

#### 2.2.3 单点交叉算子

#### 单点交叉算子是最常用和最基本的交叉操作算子。单点交叉算子的具体执行过程如下所示：

#### > 1. 对群体中的个体进行两两随机配对；,> 2. 对每对相互配对的个体，随机设置某一基因座之后的位置为交叉点；,> 3. 对每对相互配对的个体，依设定的交叉概率在其交叉点出相互交换两个个体的部分染色体，从而产生出两个新的个体。

$A$: 1 0 1 1 0 1 1 1 | 0 0 $\longrightarrow$ $A^{\prime}$ : 1 0 1 1 0 1 1 1 | 1 1

$B$: 0 0 0 1 1 1 0 0 | 1 1 $\longrightarrow$ $B^{\prime}$ : 0 0 0 1 1 1 0 0 | 0 0

#### 2.2.4 基本位变异算子

具体执行过程如下：

> 1. 对个体的每一个基因座，依据变异概率指定其为变异点；
> 2. 对每个指定点，对其基因值做取反运算或用其等位基因值来替代，从而产生一个新的个体。

$A$: 1 0 1 1 <u>0</u> 1 1 1  $\longrightarrow$ $A^{\prime}$ : 1 0 1 1 <u>1</u> 1 1 1 

#### 2.2.4 基本遗传算法应用步骤

**第一步：** 确定决策变量及其各种约束条件，即确定出个体的表现型和问题的解空间；

**第二步：** 建立优化模型，即确定出目标函数的类型及其数学描述形式或量化方法；

**第三步：** 确定表示可行解的染色体编码方法，即确定出个体的基因型及遗传算法的搜索空间；

**第四步：** 确定编码方法，即确定出由个体基因型到个体表现型的对应关系或转换方法；

**第五步：** 确定个体适应度的量化评价方法，即确定出由目标函数值到个体适应度的转换规则；

**第六步：** 设计遗传算子，即确定出选择运算、交叉运算、变异运算等遗传算子的具体操作方法；

**第七步：** 确定遗传算法的有关运行参数，即确定出遗传算法的$M, T, p_c, p_m$ 等参数。











